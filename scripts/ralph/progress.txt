# Ralph Progress Log
Started: 2025-01-09

## Codebase Patterns
- Use Vite template `react-ts` for new React + TypeScript projects
- CSS custom properties in :root for theme colors and typography
- Google Fonts imported via @import in index.css
- Typecheck with `npx tsc --noEmit` in react-flow-app directory
- React Flow components live in src/components/, wrap app in ReactFlowProvider
- React Flow CSS import: `import "@xyflow/react/dist/style.css"` in App.tsx
- Types live in src/types/presentation.ts - import node types and data interfaces from there
- Custom nodes: Create in src/components/nodes/, register in nodeTypes, use NodeProps<T> for typing
- Utility functions: Create in src/utils/, export typed functions that return React Flow nodes/edges
- Custom hooks: Create in src/hooks/, use useReactFlow() from @xyflow/react to access fitView
- Panels: Create in src/components/panels/, use position: absolute for overlay positioning on ReactFlow canvas
- Data files: Create in src/data/, export typed arrays (sections[], slides[], resources[]) for presentation content
- NEVER add CSS transitions to .react-flow__viewport - use fitView({ duration: X }) for smooth programmatic navigation instead
---

## 2025-01-09 - US-001
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Initialized Vite + React + TypeScript project in react-flow-app/
- Configured vite.config.ts with dev server port 5173 and sourcemaps
- Added CSS reset and Google Fonts imports (Space Grotesk, Inter, JetBrains Mono)
- Created Slate Canvas theme with CSS custom properties for colors
- Cleaned up default Vite template with minimal App component
- Files changed: react-flow-app/ (new directory with 16 files)
- **Learnings for future iterations:**
  - npm create vite@latest works with `--template react-ts` for TypeScript support
  - Dev server starts on port 5173 by default
  - Typecheck passes with clean template after simplifying App.tsx
---

## 2025-01-09 - US-002
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Installed @xyflow/react v12.10.0 and react-remark v2.1.0
- Created App.tsx with ReactFlowProvider wrapper
- Created PresentationCanvas component with empty ReactFlow canvas
- Configured dark background (#0f172a) matching Slate Canvas theme
- Added Background component with subtle dot pattern
- Files changed: package.json, package-lock.json, src/App.tsx, src/App.css, src/components/PresentationCanvas.tsx
- **Learnings for future iterations:**
  - Import @xyflow/react CSS with `import "@xyflow/react/dist/style.css"`
  - ReactFlowProvider must wrap parent component containing ReactFlow
  - Port 5173 may be in use from previous sessions; Vite auto-increments to 5174
  - Background component accepts variant (Dots/Lines/Cross), gap, size, and color props
  - Use `proOptions={{ hideAttribution: true }}` to remove React Flow attribution
---

## 2025-01-09 - US-003
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Created src/types/presentation.ts with comprehensive type definitions
- Defined Track type for parallel presentation tracks (non-technical, technical, general)
- Defined Section interface with id, title, track fields
- Defined SlideContent interface with id, sectionId, type, title, subtitle?, bullets?, quote?, level? fields
- Defined Resource interface with id, slideId, type, title, url fields
- Created node data interfaces: SlideNodeData, SectionHeaderNodeData, ResourceNodeData
- Created typed React Flow node types: SlideNode, SectionHeaderNode, ResourceNode using Node<Data, Type> pattern
- Added NodeProps types for custom node components
- Exported NODE_DIMENSIONS and TRACK_COLORS constants for consistent styling
- Files changed: react-flow-app/src/types/presentation.ts (new file)
- **Learnings for future iterations:**
  - Use Node<DataType, "nodeType"> pattern from @xyflow/react for typed nodes
  - Use NodeProps<NodeType> for component props in custom node components
  - Include optional fields like level? for slides that have level indicators (Level 0-8)
  - Constants for dimensions and colors should be exported for use in node components and layout utilities
---

## 2025-01-09 - US-004
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Created SlideNode custom React Flow component with CSS styling
- Implemented four slide type variants: title, section-header, content, quote
- Added track-colored left borders using TRACK_COLORS constants
- Implemented bullet point preview with max 3 items and "+N more" indicator
- Added level badge display for slides with level indicators
- Added Playfair Display font import for italic subtitles and quotes
- Registered SlideNode as custom node type in PresentationCanvas with sample data
- Files changed: src/components/nodes/SlideNode.tsx, src/components/nodes/SlideNode.css, src/components/PresentationCanvas.tsx, src/index.css
- **Learnings for future iterations:**
  - Custom nodes must be registered in nodeTypes object passed to ReactFlow component
  - Use Handle component from @xyflow/react for connection points (Position.Top/Bottom)
  - BEM naming convention for CSS classes (e.g., slide-node__title, slide-node--active)
  - Type SlideNodeProps from presentation.ts for component props
  - Add fonts to Google Fonts URL with proper weight/style specs
---

## 2025-01-09 - US-005
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Created SectionHeaderNode custom React Flow component with CSS styling
- Node dimensions: 320x120px as specified in NODE_DIMENSIONS constants
- Display section title with Space Grotesk 600 weight, centered
- Implemented track-specific gradient backgrounds:
  - non-technical: emerald gradient (#10b981)
  - technical: blue gradient (#3b82f6)
  - general: gray gradient (#6b7280)
- Added active state styling with glowing border effect
- Added Handles for Left, Right, and Bottom positions for flexible edge connections
- Registered SectionHeaderNode in PresentationCanvas nodeTypes
- Added sample section header nodes for all three tracks to test styling
- Updated PresentationCanvas to use combined sample nodes array
- Files changed: src/components/nodes/SectionHeaderNode.tsx (new), src/components/nodes/SectionHeaderNode.css (new), src/components/PresentationCanvas.tsx
- **Learnings for future iterations:**
  - CSS custom properties (--track-color) can be set inline via style prop with type assertion
  - Track-specific modifier classes (--non-technical, --technical, --general) work well for gradient backgrounds
  - Section headers use Left/Right handles for horizontal section-to-section connections
  - Multiple sample node arrays can be combined with spread operator for testing multiple node types
---

## 2025-01-09 - US-006
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Created ResourceNode custom React Flow component with CSS styling
- Node dimensions: 140x80px as specified in NODE_DIMENSIONS constants
- Implemented dashed border styling to distinguish from main slide nodes
- Created inline SVG icons for all 5 resource types:
  - article: document with lines icon (amber #f59e0b)
  - tool: wrench icon (violet #8b5cf6)
  - video: play button icon (red #ef4444)
  - docs: document with page corner icon (emerald #10b981)
  - github: github fork/branch icon (gray #6b7280)
- Implemented title truncation (max 20 characters with ellipsis)
- Added click handler using window.open() with noopener,noreferrer for security
- Added type badge showing resource type in uppercase
- Registered ResourceNode in PresentationCanvas nodeTypes
- Added 5 sample resource nodes (one of each type) to test all styling variations
- Verified in browser that clicking ResourceNode opens external URL in new tab
- Files changed: src/components/nodes/ResourceNode.tsx (new), src/components/nodes/ResourceNode.css (new), src/components/PresentationCanvas.tsx
- **Learnings for future iterations:**
  - Use CSS custom properties (--resource-color) for type-specific accent colors
  - SVG icons can be defined inline as JSX and stored in a Record<ResourceType, JSX.Element> for easy lookup
  - Position.Left handle for resource nodes since they connect from parent slides on the left
  - Use onClick handler directly on the node div for click-to-open functionality
  - window.open with 'noopener,noreferrer' prevents opened tab from accessing opener
---

## 2025-01-09 - US-007
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Created src/utils/generateNodes.ts for automatic node positioning
- Implemented clustered layout algorithm:
  - Section headers positioned horizontally with 600px spacing
  - Slides positioned vertically below section headers with 220px spacing
  - Resource nodes positioned 160px to the right of parent slides
- Added SECTION_HORIZONTAL_SPACING, SLIDE_VERTICAL_SPACING, RESOURCE_OFFSET constants
- Groups slides by sectionId using Map for efficient lookup
- Groups resources by slideId for vertical stacking
- Returns typed PresentationNode[] array ready for React Flow
- Added helper function getNodeCenter() for fitView calculations
- Files changed: src/utils/generateNodes.ts (new)
- **Learnings for future iterations:**
  - Utility functions go in src/utils/ directory
  - Use Map<string, T[]> pattern for grouping items by parent ID
  - Position calculations should use constants for maintainability
  - Resource nodes stack vertically with 100px spacing when multiple per slide
---

## 2025-01-09 - US-008
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Created src/utils/generateEdges.ts for styled edge connections
- Implemented three edge types with distinct visual styles:
  - Section-to-section: 3px indigo #6366f1 stroke, animated for major flow
  - Slide-to-slide: 1.5px gray #4b5563 solid stroke for vertical section flow
  - Slide-to-resource: 1px gray #6b7280 dashed stroke for resource connections
- Added section-to-first-slide edges connecting headers to their content
- Uses EDGE_STYLES constant object for maintainable style definitions
- Maps sections, slides, and resources to build complete edge graph
- Returns typed Edge[] array ready for React Flow
- Files changed: src/utils/generateEdges.ts (new)
- **Learnings for future iterations:**
  - Use sourceHandle/targetHandle props to connect specific handles (left/right/top/bottom)
  - Edge animated prop creates flowing animation effect, good for primary navigation paths
  - strokeDasharray: "5,5" creates dashed line effect for subtle connections
  - Group by parent ID patterns from generateNodes apply to edge generation as well
---

## 2025-01-09 - US-009
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Created src/hooks/useKeyboardNavigation.ts for keyboard-based slide navigation
- Implemented arrow key navigation:
  - Up/Down: Navigate between slides within current section
  - Left/Right: Navigate to first slide of adjacent sections
- Implemented section jumping:
  - PageUp/PageDown: Jump to previous/next section
  - Number keys 1-9: Jump directly to numbered section
- Integrates with React Flow fitView for smooth 500ms transitions with padding
- Updated PresentationCanvas to use generateNodes/generateEdges utilities
- Added click-to-navigate functionality via onNodeClick handler
- Added active slide state tracking with visual highlighting
- Files changed: src/hooks/useKeyboardNavigation.ts (new), src/components/PresentationCanvas.tsx
- **Learnings for future iterations:**
  - useReactFlow() hook provides fitView function for programmatic navigation
  - fitView accepts nodes array with partial objects (just {id} is sufficient)
  - fitView options: duration (ms), padding, maxZoom control transition behavior
  - Use window.addEventListener for global keyboard events in hooks
  - NodeMouseHandler type from @xyflow/react for typed onNodeClick handlers
  - Node IDs use format `slide-{slideId}` and `section-{sectionId}` - match these in fitView calls
---

## 2025-01-09 - US-010
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Added overview mode toggle via Escape key to zoom out and show all nodes
- Added 0 key to fit current slide to view (zoom back from overview)
- Implemented isOverviewMode state tracking in useKeyboardNavigation hook
- Added toggleOverview() and fitCurrentSlide() functions
- All fitView calls use 500ms duration for smooth transitions
- Updated PresentationCanvas to support section header navigation via click
- Click on any node exits overview mode and focuses that node
- Files changed: src/hooks/useKeyboardNavigation.ts, src/components/PresentationCanvas.tsx
- **Learnings for future iterations:**
  - fitView without nodes array fits ALL nodes in the viewport
  - Use minZoom/maxZoom options to control zoom constraints in fitView
  - Don't call setState inside setState callback when also calling external functions (React warning)
  - Visual zoom differences may be subtle with small sample data - full presentation will show clearer distinction
---

## 2025-01-09 - US-011
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Added React Flow MiniMap component to PresentationCanvas
- Imported MiniMap from @xyflow/react
- Positioned minimap in bottom-right corner using position="bottom-right"
- Implemented nodeColor function to color nodes by track:
  - Section headers and slides: Use TRACK_COLORS based on section.track
  - Resource nodes: Muted gray #4b5563
- Styled minimap with dark background matching Slate Canvas theme
- Added maskColor for viewport highlighting
- Files changed: src/components/PresentationCanvas.tsx
- **Learnings for future iterations:**
  - MiniMap component accepts nodeColor callback to dynamically color nodes
  - Use type assertions to access nested node data in nodeColor callback
  - position prop accepts "top-left", "top-right", "bottom-left", "bottom-right"
  - MiniMap automatically shows current viewport position as highlighted area
  - Import TRACK_COLORS constant from presentation.ts for consistent styling
---

## 2025-01-09 - US-012
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Created SectionNavigator panel component for quick section navigation
- Created src/components/panels/SectionNavigator.tsx with TypeScript props interface
- Created src/components/panels/SectionNavigator.css with dark theme styling
- Panel displays all sections with numbered list (1, 2, 3...)
- Shows section titles with track color indicators (emerald/blue/gray dots)
- Highlights current section with active state and track-colored left border
- Click on section calls navigateToSection to jump to section header node
- Positioned on left side using position: absolute with backdrop blur effect
- Updated PresentationCanvas to wrap ReactFlow in container div for overlay positioning
- Added currentSectionId to destructured values from useKeyboardNavigation hook
- Files changed: src/components/panels/SectionNavigator.tsx (new), src/components/panels/SectionNavigator.css (new), src/components/PresentationCanvas.tsx
- **Learnings for future iterations:**
  - Panels live in src/components/panels/ directory
  - Wrap ReactFlow in a container div with position: relative for overlay panels
  - useKeyboardNavigation hook returns currentSectionId - must destructure to use
  - CSS custom properties (--track-color) for dynamic track coloring via inline styles
  - Use aria-current="true" for accessibility on active navigation items
---

## 2025-01-09 - US-013
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Created src/data/slides.ts with all 15 slides extracted from index.html
- Organized slides into 4 logical sections:
  - The Widening Gulf (general track): Technology and the Widening Gulf, Mental Models Through Use
  - Understanding AI (non-technical track): New Tech Old Mental Models, From Confidant to Digital Employee
  - Mapping the Journey (general track): Mapping the Journey, The Wrong Split
  - The Levels (non-technical track): Levels 0-8 (Avoidance through Natural Language Software)
- Updated PresentationCanvas to import and use real slide data from slides.ts
- Replaced sample data with actual presentation content
- Added helper functions: getSlidesBySection(), getSectionById()
- Files changed: src/data/slides.ts (new), src/components/PresentationCanvas.tsx
- **Learnings for future iterations:**
  - Data files live in src/data/ directory
  - Keep data separate from components - PresentationCanvas imports data, doesn't define it
  - Resources array is empty placeholder for US-014
  - Slide IDs use format `slide-01`, `slide-02` etc. for human readability
  - Each slide references sectionId to group slides by section
---

## 2025-01-09 - US-014
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Added 7 resource nodes to src/data/slides.ts linking to external tools and documentation
- Resource nodes attached to key slides in "The Levels" section:
  - Level 1 (slide-08): ChatGPT - chat.openai.com
  - Level 2 (slide-09): Claude AI - claude.ai
  - Level 4 (slide-11): Wispr Flow and Granola Notes (two resources on same slide)
  - Level 6 (slide-13): Midjourney
  - Level 7 (slide-14): Zapier Guide (docs type)
  - Level 8 (slide-15): Lovable Dev
- Updated PresentationCanvas.tsx to import resources from slides.ts (removed empty placeholder array)
- Verified in browser: All 7 resource nodes visible in React Flow canvas, click opens new tab
- Files changed: src/data/slides.ts, src/components/PresentationCanvas.tsx
- **Learnings for future iterations:**
  - Resources array exports from slides.ts alongside sections[] and slides[]
  - Multiple resources can attach to same slide - generateNodes stacks them vertically with 100px spacing
  - Resource IDs use format `res-01`, `res-02` etc. for human readability
  - SlideId references use the slide ID without "slide-" prefix (e.g., "slide-08" not "slide-slide-08")
---

## 2025-01-09 - US-015
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Added smooth edge transitions and hover effects in App.css
- Implemented window resize handler with debounced fitView in PresentationCanvas.tsx
- Added responsive media queries for 1366px and 1280px viewport sizes
- Enhanced minimap and controls styling for dark theme consistency
- Added responsive adjustments to SectionNavigator.css (font sizes, padding, spacing)
- Tested at viewport sizes: 1920x1080, 1366x768, 1280x720 - no visual glitches
- Files changed: src/App.css, src/components/PresentationCanvas.tsx, src/components/panels/SectionNavigator.css
- **Learnings for future iterations:**
  - Use debounced resize handler (150ms) to avoid excessive fitView calls during window resize
  - React Flow edge transitions can be styled via .react-flow__edge-path CSS selector
  - Viewport transition smoothness can be added via .react-flow__viewport CSS transition
  - Media queries should target both :root for CSS variables and specific components
  - The edge warnings in console (about missing handles) don't affect functionality - they occur when edges reference handles that exist but aren't visible
---

## 2025-01-10 - US-016
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Added explicit id attributes to Handle components in SlideNode.tsx
- Added id="top" to target Handle at Position.Top
- Added id="bottom" to source Handle at Position.Bottom
- Added NEW source Handle with id="right" at Position.Right for resource connections
- Files changed: src/components/nodes/SlideNode.tsx
- **Learnings for future iterations:**
  - Handle id attributes must match sourceHandle/targetHandle values in generateEdges.ts
  - SlideNode needs right handle for slide-to-resource connections (edges reference sourceHandle: "right")
  - Handle components can have both type and id - id is what edge connections reference
---

## 2025-01-10 - US-017
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Added explicit id attributes to Handle components in SectionHeaderNode.tsx and ResourceNode.tsx
- Added id="left" to target Handle at Position.Left in SectionHeaderNode
- Added id="right" to source Handle at Position.Right in SectionHeaderNode
- Added id="left" to target Handle at Position.Left in ResourceNode
- Verified in browser: all edges now render correctly between nodes
- Console warnings about missing handle IDs have been eliminated
- Files changed: src/components/nodes/SectionHeaderNode.tsx, src/components/nodes/ResourceNode.tsx
- **Learnings for future iterations:**
  - All Handle components need explicit id attributes that match the sourceHandle/targetHandle values in generateEdges.ts
  - Section headers use left/right handles for horizontal section-to-section edges, bottom handle for section-to-first-slide edges
  - Resource nodes only need a target handle (left) since they receive edges from slides, not emit them
  - Edge visibility in browser is the best way to confirm handle IDs are correct - look for all edge types rendering
---

## 2025-01-10 - US-018
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Wrapped all three node components with React.memo() for performance optimization
- Added `import { memo } from "react"` to each component file
- Changed exports to `export default memo(ComponentName)` pattern
- Files changed: src/components/nodes/SlideNode.tsx, src/components/nodes/SectionHeaderNode.tsx, src/components/nodes/ResourceNode.tsx
- **Learnings for future iterations:**
  - React.memo() wraps the exported component, not the function declaration
  - Import memo from 'react' at the top of the file alongside other React imports
  - This optimization prevents unnecessary re-renders when parent components change but node data remains the same
---

## 2025-01-10 - US-019
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Optimized PresentationCanvas performance with two key improvements
- Added useRef to track previous active slide ID for comparison
- Refactored nodesWithActiveState useMemo to only create new objects when isActive actually changes for a node
- Wrapped MiniMap nodeColor callback in useCallback with empty dependency array to prevent unnecessary re-renders
- Files changed: src/components/PresentationCanvas.tsx
- **Learnings for future iterations:**
  - Use useRef to track previous state values across renders for comparison in useMemo
  - The pattern `wasActive !== isActive` detects when a specific node's active state changed, not just when the global currentSlideId changed
  - MiniMap's nodeColor callback is called for every node on every render - wrapping in useCallback prevents new function instance creation
  - useCallback with empty deps array is fine when the function only uses stable references (like TRACK_COLORS constant)
---

## 2025-01-10 - US-020
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Disabled animated edges for improved panning performance
- Changed EDGE_STYLES.sectionToSection.animated from true to false in generateEdges.ts
- Verified in browser that canvas panning is responsive without animation overhead
- Files changed: src/utils/generateEdges.ts
- **Learnings for future iterations:**
  - Animated edges cause continuous repaints which can impact performance during panning
  - Simple boolean flag change in EDGE_STYLES constant disables animation for edge type
  - Static edges still provide clear visual connections without performance cost
---

## 2025-01-10 - US-021
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Updated NODE_DIMENSIONS in types/presentation.ts for larger slides
- Changed slide dimensions from 280x180 to 520x400 (larger for hero image layout)
- Changed sectionHeader dimensions from 320x120 to 400x140
- Changed resource dimensions from 140x80 to 160x90
- Files changed: src/types/presentation.ts
- **Learnings for future iterations:**
  - NODE_DIMENSIONS constant in types/presentation.ts is used throughout the codebase for node sizing
  - These dimensions prepare for the hero image layout in upcoming stories
  - Larger slides allow for more content and a dedicated image area
---

## 2025-01-10 - US-022
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Redesigned SlideNode for hero image layout
- Added slide-node__hero div as dedicated image container (60% height)
- Moved content-wrapper to bottom (40% height)
- Level badge now positioned inside hero area
- Changed border from left-side (borderLeftColor) to top (borderTopColor)
- Removed --has-image modifier class and overlay div in favor of dedicated hero container
- Files changed: src/components/nodes/SlideNode.tsx
- **Learnings for future iterations:**
  - Hero image layouts use separate container divs rather than background-image on the node
  - Level badges should overlay the hero image area for visual hierarchy
  - Top border color works better than left border for wide slide nodes
---

## 2025-01-10 - US-023
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Updated SlideNode CSS for hero image layout
- Added .slide-node__hero class with flex: 0 0 60%, background-size: cover
- Changed .slide-node padding from var(--spacing-md) to 0 (content-wrapper has padding)
- Updated .slide-node__content-wrapper to flex: 0 0 40% for bottom area
- Updated .slide-node__level with white text, darker background (rgba(0,0,0,0.6)), backdrop-filter blur
- Changed border from border-left to border-top
- Increased font sizes: title 14px→18px, subtitle 12px→14px, bullets 11px→13px
- Files changed: src/components/nodes/SlideNode.css
- **Learnings for future iterations:**
  - Use flex: 0 0 percentage for fixed-ratio layouts (60%/40% split)
  - Level badges on images need high contrast - white text on dark translucent background
  - backdrop-filter: blur(4px) adds visual polish to overlay elements
  - Remove padding from parent when children handle their own padding
---

## 2025-01-10 - US-024
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Adjusted layout spacing constants in generateNodes.ts for larger slides
- Updated SECTION_HORIZONTAL_SPACING from 600 to 800
- Updated SLIDE_VERTICAL_SPACING from 220 to 450
- Fixed resourceX calculation to use 520 (new slide width) instead of 280 (old width)
- Updated function documentation to reflect new spacing values
- Files changed: src/utils/generateNodes.ts
- **Learnings for future iterations:**
  - Layout constants in generateNodes.ts control node spacing on the canvas
  - When slide dimensions change, remember to update hardcoded width references (like resourceX calculation)
  - Larger slides require proportionally larger spacing to maintain readability
---

## 2025-01-10 - US-025
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Added sequential navigation functions to useKeyboardNavigation hook
- Added goToNextSlide() function that navigates to next slide in orderedSlides sequence
- Added goToPreviousSlide() function that navigates to previous slide
- Added currentSlideIndex calculation (0-indexed position in orderedSlides array)
- Added totalSlides count (orderedSlides.length)
- Updated UseKeyboardNavigationReturn interface to export new functions and values
- Files changed: src/hooks/useKeyboardNavigation.ts
- **Learnings for future iterations:**
  - orderedSlides already exists in the hook - just need to calculate currentSlideIndex from it
  - goToNextSlide/goToPreviousSlide reuse the existing navigateToSlide function
  - currentSlideIndex returns -1 when no slide is selected (currentSlideId is null)
  - These exports enable NavigationControls component to show progress and handle button clicks
---

## 2025-01-10 - US-026
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Created NavigationControls component in src/components/panels/NavigationControls.tsx
- Created NavigationControls.css with floating pill design and backdrop blur
- Implemented Previous button with gray styling (slate-500 based)
- Implemented Next button with orange/coral color (#f97316, orange-500)
- Added progress indicator showing "X / Y" format with JetBrains Mono font
- Added overview toggle button with 4-grid icon, highlights when overview mode active
- Buttons correctly disabled at first/last slide positions
- Wrapped component in React.memo for performance optimization
- Added responsive styles for mobile viewports (768px and 480px breakpoints)
- Files changed: src/components/panels/NavigationControls.tsx (new), src/components/panels/NavigationControls.css (new)
- **Learnings for future iterations:**
  - NavigationControls receives props from useKeyboardNavigation: currentSlideIndex, totalSlides, goToNextSlide, goToPreviousSlide, toggleOverview, isOverviewMode
  - Use displayIndex = currentSlideIndex + 1 for 1-indexed display to users
  - isFirstSlide = currentSlideIndex <= 0, isLastSlide = currentSlideIndex >= totalSlides - 1 for button disable logic
  - Dark theme pill (rgba(15, 23, 42, 0.9)) with backdrop blur matches SectionNavigator styling pattern
---

## 2025-01-10 - US-027
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Integrated NavigationControls component into PresentationCanvas
- Imported NavigationControls from ./panels/NavigationControls
- Destructured additional values from useKeyboardNavigation: currentSlideIndex, totalSlides, goToNextSlide, goToPreviousSlide, toggleOverview
- Passed all required props to NavigationControls component: currentSlideIndex, totalSlides, isOverviewMode, onPrevious, onNext, onToggleOverview
- Navigation controls now appear at bottom center of canvas (positioned via CSS in NavigationControls.css)
- Verified in browser: Next/Previous buttons visible and functional, progress indicator updates correctly
- Files changed: src/components/PresentationCanvas.tsx
- **Learnings for future iterations:**
  - NavigationControls props use callback naming convention: onPrevious, onNext, onToggleOverview (matching the component's interface)
  - The hook already exports goToNextSlide/goToPreviousSlide - just need to destructure and pass as props
  - Panel components overlay on the ReactFlow canvas using position: absolute within the container div
---

## 2025-01-10 - US-028
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Enabled node dragging in PresentationCanvas
- Converted nodes from useMemo to useState to allow position updates during drag
- Added onNodesChange handler using applyNodeChanges from @xyflow/react
- Set nodesDraggable={true} on ReactFlow component
- Imported useState, applyNodeChanges, and NodeChange type
- Verified in browser: nodes can be dragged to new positions, edges automatically follow
- Files changed: src/components/PresentationCanvas.tsx
- **Learnings for future iterations:**
  - To enable dragging, nodes must be in useState (not useMemo) so positions can be updated
  - applyNodeChanges from @xyflow/react handles all node change events (drag, selection, etc.)
  - NodeChange<T> type from @xyflow/react provides proper typing for the changes callback
  - nodesDraggable={true} is required on ReactFlow component to enable drag behavior
  - Edges automatically update to follow dragged nodes without additional configuration
  - onNodeClick still fires during drag operations - dragging works but clicking also navigates
---

## 2025-01-10 - US-029
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Updated CSS custom properties in index.css for brighter theme
- Changed --color-bg-primary from dark (#0f172a) to white (#ffffff)
- Changed --color-text-primary from light (rgba(255, 255, 255, 0.95)) to dark (#0f172a) for better contrast
- Changed --color-text-secondary from light (rgba(255, 255, 255, 0.7)) to dark (#334155)
- Changed --color-text-muted from light (rgba(255, 255, 255, 0.5)) to gray (#94a3b8)
- Files changed: src/index.css
- **Learnings for future iterations:**
  - CSS custom properties in :root control the entire theme color scheme
  - The transition from dark to light theme requires inverting text colors (light text on dark -> dark text on light)
  - Background and text colors are paired - update them together to maintain contrast
---

## 2025-01-10 - US-030
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Updated SectionNavigator.css for light theme
- Changed background from dark (rgba(15, 23, 42, 0.95)) to light (rgba(255, 255, 255, 0.95))
- Changed border from light (rgba(255, 255, 255, 0.1)) to dark (rgba(0, 0, 0, 0.1))
- Updated header border-bottom to dark (rgba(0, 0, 0, 0.1))
- Changed hover states from light overlays to dark overlays
- Reduced box-shadow intensity for light theme (0.4 → 0.1 opacity)
- Text colors already handled by CSS custom properties updated in US-029
- Files changed: src/components/panels/SectionNavigator.css
- **Learnings for future iterations:**
  - Components using CSS custom properties (--color-text-*) automatically update when root variables change
  - For light themes, update rgba() values from white-based to black-based for borders, shadows, and overlays
  - backdrop-filter: blur() works well on both light and dark themes
---

## 2025-01-10 - US-031
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Added image lazy loading to SlideNode component
- Converted hero image from CSS background-image to <img> element with loading="lazy" attribute
- Added slide-node__hero-image CSS class with object-fit: cover for proper image scaling
- Added overflow: hidden to slide-node__hero container
- Removed background-size and background-position from hero container (now handled by <img> styles)
- Images now load as they come into viewport, improving initial load performance
- Files changed: src/components/nodes/SlideNode.tsx, src/components/nodes/SlideNode.css
- **Learnings for future iterations:**
  - CSS background-image does not support native lazy loading - must use <img> element with loading="lazy"
  - Use object-fit: cover and object-position: center on <img> for same effect as background-size: cover
  - Always add overflow: hidden to container when using object-fit to prevent image overflow
  - The alt attribute should use slide.title for accessibility
---

## 2025-01-10 - US-032
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Fixed slide image sizing for full display
- Changed object-fit from cover to contain to show full images without cropping
- Adjusted hero/content height ratio from 60/40 to 69/31 for proper 16:9 image display
- Updated slide height from 400px to 420px to accommodate the image aspect ratio
- Added flexbox centering to hero container (display: flex, align-items/justify-content: center)
- Reduced content area padding from var(--spacing-md) to var(--spacing-sm) var(--spacing-md)
- Files changed: src/types/presentation.ts, src/components/nodes/SlideNode.css
- **Learnings for future iterations:**
  - All slide images are 1376x768 pixels (approximately 16:9 / 1.79:1 aspect ratio)
  - object-fit: contain shows full image but may leave letterbox bars; cover fills area but crops
  - When using contain, the container should have flexbox centering to properly position the image
  - Slide dimensions should be calculated based on image aspect ratio plus content area height
---

## 2025-01-10 - US-033
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Removed CSS transition on .react-flow__viewport that was causing panning lag
- The `transition: transform 0.3s ease-out` rule was animating every pan movement
- Canvas now moves instantly with mouse during manual panning
- React Flow handles smooth transitions internally via fitView({ duration: X }) for programmatic navigation
- Verified in browser: pan operation immediately updates viewport transform
- Files changed: src/App.css
- **Learnings for future iterations:**
  - Never add CSS transitions to .react-flow__viewport - this causes panning lag
  - React Flow uses inline style transforms which CSS transitions will animate
  - For smooth programmatic navigation, use fitView({ duration: X }) instead of CSS transitions
  - The viewport transform is managed by React Flow and should not have external CSS transitions
---

## 2025-01-10 - US-034
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Added lined notepad paper background using CSS gradients
- Replaced React Flow's Background component (dot pattern) with custom CSS on .react-flow__pane
- Added CSS custom properties for notepad colors: --color-notepad-line, --color-notepad-margin
- Changed background color from #ffffff to #fffef8 (off-white/cream) for paper authenticity
- Horizontal ruled lines using repeating-linear-gradient (24px spacing, subtle blue rgba(120, 160, 200, 0.3))
- Red/pink margin line on left side using linear-gradient (79-81px from left edge)
- Removed Background component import and usage from PresentationCanvas.tsx
- Verified in browser: background displays lined notebook paper effect with cream color, blue lines, and red margin
- Files changed: src/index.css, src/App.css, src/components/PresentationCanvas.tsx
- **Learnings for future iterations:**
  - React Flow's Background component doesn't support custom patterns - use CSS on .react-flow__pane instead
  - Combine multiple background-image gradients for layered effects (margin line + ruled lines)
  - Use repeating-linear-gradient for evenly spaced horizontal lines
  - CSS custom properties allow theme colors to be changed in one place
---

## 2025-01-10 - US-035
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Enhanced edge visibility by increasing stroke widths and darkening colors
- Updated EDGE_STYLES in generateEdges.ts:
  - Section-to-section: 4px indigo-600 (#4f46e5)
  - Slide-to-slide: 2.5px slate-800 (#1e293b) for visibility on cream paper
  - Slide-to-resource: 1.5px slate-500 (#64748b) dashed
- All edges connect properly:
  - Section headers connect horizontally (left/right handles)
  - Section headers connect to first slide (bottom/top handles)
  - Slides connect vertically in sequence (bottom/top handles)
  - Slides connect to resources (right/left handles)
- Verified in browser: edges render correctly with visible connection points
- Files changed: src/utils/generateEdges.ts
- **Learnings for future iterations:**
  - Edge visibility depends on stroke width and color contrast with background
  - For cream/white backgrounds, use darker colors (slate-800 instead of gray-600)
  - Edges appear as short lines or dots when nodes are close together - this is expected
  - The accessibility tree shows all edges even when they're not easily visible on screen
---

## 2025-01-10 - US-036
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Added optional 'image' field to Resource type for custom thumbnail images
- Updated ResourceNode component to display thumbnail images with icon fallback
- Added useState hook to track image loading errors for graceful fallback
- Increased resource node dimensions from 160x90 to 180x120 to accommodate images
- Updated ResourceNode CSS with new thumbnail container and layout for image mode
- Added resource-node--has-image modifier class for image-specific styling
- Added image URLs for all 7 resources (ChatGPT, Claude AI, Wispr Flow, Granola, Midjourney, Zapier, Lovable)
- Verified in browser: resource nodes display images correctly with fallback working
- Files changed: src/types/presentation.ts, src/components/nodes/ResourceNode.tsx, src/components/nodes/ResourceNode.css, src/data/slides.ts
- **Learnings for future iterations:**
  - og:image fetching requires CORS proxy/server-side handling - static image URLs are simpler
  - Use onError handler on <img> to gracefully fall back to icon when image fails to load
  - useState for imageError state allows component to re-render with fallback
  - Conditional className with ternary works well for has-image modifier: `${hasImage ? "resource-node--has-image" : ""}`
  - favicon.ico and apple-touch-icon.png are commonly available public image URLs for tools/services
---

## 2025-01-10 - US-037
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Created slides.md markdown file in src/data/ with all 15 slides in editable format
- Used YAML-like frontmatter between `---` markers for slide metadata (id, sectionId, type, level)
- Included slide titles, subtitles, bullet points in bold-labeled sections
- Added markdown image syntax for each slide with preview capability
- Added Resources sections for slides that link to external tools
- Created section reference table showing section IDs, titles, and tracks
- Included original talk outline at bottom for content reference
- Added format documentation at top explaining how to edit the file
- Files changed: src/data/slides.md (new file, 548 lines)
- **Learnings for future iterations:**
  - Markdown files in src/data/ can store editable content alongside TypeScript data files
  - YAML-like frontmatter between `---` markers provides structured metadata
  - Bold labels like `**Title:**` create clear visual hierarchy for editable fields
  - Including original reference material (talk outline) helps maintain content consistency
  - The markdown format allows preview of slide images directly in editors that support it
---

## 2025-01-12 - US-038
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Created src/utils/persistence.ts for localStorage-based node position persistence
- Implemented loadPersistedPositions() function that returns Record<string, {x, y}> or null
- Implemented savePersistedPositions(positions) function with version and timestamp
- Implemented clearPersistedPositions() function to reset stored positions
- Used localStorage key 'presentation-node-positions'
- Added graceful error handling for JSON parse errors and localStorage quota
- Exported NodePosition interface for use in other modules
- Files changed: src/utils/persistence.ts (new file, 82 lines)
- **Learnings for future iterations:**
  - Persistence utilities go in src/utils/ alongside other utility modules
  - Use version field in stored data for future migration support
  - Wrap localStorage operations in try/catch for quota exceeded errors
  - Export interfaces alongside functions for type reuse
---

## 2025-01-12 - US-039
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Added import for loadPersistedPositions from persistence.ts in PresentationCanvas.tsx
- Modified useState initializer to load persisted positions from localStorage
- Merged persisted positions with generated nodes (nodes with persisted positions get their position overwritten)
- Updated paper background calculation to use nodes with merged positions
- Verified typecheck passes
- Files changed: src/components/PresentationCanvas.tsx
- **Learnings for future iterations:**
  - Load persisted positions at component initialization via useState initializer function
  - Use ternary/map pattern to merge positions: if persistedPositions exists, map nodes and replace positions where available
  - Paper background bounds must be calculated after merging positions so the paper wraps correctly around moved nodes
---

## 2025-01-12 - US-040
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Added debounced save function (500ms delay) for node position persistence
- Imported savePersistedPositions from persistence.ts
- Added SAVE_DEBOUNCE_MS constant (500ms)
- Added saveTimeoutRef ref to track debounce timeout
- Created debouncedSavePositions callback that:
  - Clears existing timeout
  - Sets new timeout to save positions after 500ms
  - Extracts only position data (x, y) from nodes
  - Skips non-draggable nodes like paper background
- Added cleanup effect to clear timeout on unmount
- Updated onNodesChange to detect position changes and trigger debounced save
- Verified in browser: node positions persist after dragging
- Files changed: src/components/PresentationCanvas.tsx
- **Learnings for future iterations:**
  - Debounce with useRef + window.setTimeout pattern for performance
  - Check change.type === "position" to detect drag operations
  - Filter out non-draggable nodes (draggable === false) before saving
  - Playwright's dragTo method may not trigger React Flow events - use page.mouse for authentic drag simulation
---

## 2025-01-12 - US-041
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Added Reset Layout button to NavigationControls component
- Added onReset prop to NavigationControlsProps interface
- Created resetLayout callback in PresentationCanvas that:
  - Calls clearPersistedPositions() to clear localStorage
  - Regenerates nodes with generateNodes()
  - Recalculates paper background bounds
  - Updates nodes state with fresh default positions
- Styled reset button with gray theme matching previous button
- Added counterclockwise arrow SVG icon for reset button
- Files changed: src/components/panels/NavigationControls.tsx, src/components/panels/NavigationControls.css, src/components/PresentationCanvas.tsx
- **Learnings for future iterations:**
  - Reset functionality requires both clearing storage AND regenerating nodes
  - Paper background node must be recalculated when nodes are regenerated
  - The resetLayout callback follows same pattern as useState initializer for node generation
---

## 2025-01-12 - US-042
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Added navigation props to SlideNodeData interface in types/presentation.ts
- Added hasPrev?: boolean for tracking if previous slide exists
- Added hasNext?: boolean for tracking if next slide exists
- Added onNavigatePrev?: () => void callback for navigating to previous slide
- Added onNavigateNext?: () => void callback for navigating to next slide
- Files changed: src/types/presentation.ts
- **Learnings for future iterations:**
  - Navigation callbacks in node data allow per-slide navigation without accessing global state
  - Optional props with ? allow components to work with or without navigation enabled
  - These props will be populated in PresentationCanvas and used by SlideNode component
---

## 2025-01-12 - US-043
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Added navigation caret buttons (‹ ›) to SlideNode component
- Created slide-node__navigation container div for button positioning
- Added handlePrevClick and handleNextClick functions with e.stopPropagation()
- Destructured hasPrev, hasNext, onNavigatePrev, onNavigateNext from data props
- Buttons are disabled when hasPrev/hasNext is false
- Added aria-label attributes for accessibility
- Files changed: src/components/nodes/SlideNode.tsx
- **Learnings for future iterations:**
  - e.stopPropagation() prevents the button click from triggering the parent node's onClick handler
  - Use disabled={!hasPrev} pattern to disable buttons based on optional boolean props
  - aria-label is important for accessibility when buttons only contain symbols
---

## 2025-01-12 - US-044
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Added CSS styles for SlideNode navigation caret buttons
- Created .slide-node__navigation container class: absolute positioning, bottom center, translateX(-50%), flexbox with gap
- Created .slide-node__nav-button class: 28px circular buttons, light background (rgba(255,255,255,0.9)), subtle border
- Added hover state: accent color background with white text
- Added disabled state: 0.4 opacity, cursor: not-allowed
- Added focus-visible state with accent color outline for accessibility
- Verified in browser: buttons visible at bottom of each slide card
- Files changed: src/components/nodes/SlideNode.css
- **Learnings for future iterations:**
  - Use transform: translateX(-50%) with left: 50% for horizontal centering of absolutely positioned elements
  - :hover:not(:disabled) prevents hover effects on disabled buttons
  - Include focus-visible styles for keyboard accessibility
  - CSS transitions on multiple properties should be comma-separated in the transition property
---

## 2025-01-12 - US-045
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Implemented navigation callbacks in PresentationCanvas for SlideNode components
- Created orderedSlides useMemo that builds slide order from sections (same logic as useKeyboardNavigation)
- Updated nodesWithActiveState useMemo to calculate hasPrev/hasNext for each slide
- Created onNavigatePrev/onNavigateNext callbacks using navigateToSlide function
- Passed hasPrev, hasNext, onNavigatePrev, onNavigateNext to each slide node's data
- Verified in browser: clicking ‹ › buttons on slides navigates correctly between slides
- Files changed: src/components/PresentationCanvas.tsx
- **Learnings for future iterations:**
  - orderedSlides can be computed from sections and slides using flatMap with slidesBySection lookup
  - Navigation callbacks should be undefined (not empty function) when not applicable for proper button disabling
  - The useMemo now depends on orderedSlides and navigateToSlide in addition to nodes and currentSlideId
---

## 2025-01-12 - US-046
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Created LevelNodeData interface in types/presentation.ts
- Added level: number, slideId: string, and track: Track fields
- Added index signature [key: string]: unknown for React Flow compatibility
- Created LevelNode type as Node<LevelNodeData, "level">
- Added LevelNode to PresentationNode union type
- Files changed: src/types/presentation.ts
- **Learnings for future iterations:**
  - LevelNode follows same pattern as other nodes: interface for data, type for Node<Data, "type">
  - Track field allows level nodes to use track-based gradient colors matching their parent slide's section
  - slideId field creates link between level node and its parent slide for edge generation
---

## 2025-01-12 - US-047
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Created LevelNode component in src/components/nodes/LevelNode.tsx
- Render 80x80px circular div with track-based gradient background
- Display level number centered in circle using JetBrains Mono font
- Added Handle on left side (Position.Left, id="left") for edge connections
- Created basic CSS file with placeholder styles for US-048
- Wrapped component in React.memo for performance optimization
- Files changed: src/components/nodes/LevelNode.tsx (new), src/components/nodes/LevelNode.css (new)
- **Learnings for future iterations:**
  - Follow same patterns as SlideNode/ResourceNode: NodeProps<NodeType> for typing
  - Gradient background uses template literal to build CSS from TRACK_COLORS constant
  - CSS file needs to exist even with minimal styles since the import in TSX won't compile otherwise
---

## 2025-01-12 - US-048
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Completed LevelNode CSS styling for circular level indicator badges
- Added 3px white border for visual definition
- Added layered drop shadow (0 4px 12px and 0 2px 4px) for depth
- Added hover effect with scale(1.05) and enhanced shadow
- Specified JetBrains Mono font explicitly with fallback to --font-mono
- Added text-shadow for better readability on gradient backgrounds
- Added smooth transitions (0.2s ease) for transform and box-shadow
- Verified typecheck passes
- Files changed: src/components/nodes/LevelNode.css
- **Learnings for future iterations:**
  - LevelNode CSS is complete but nodes won't appear until US-049 (generate), US-050 (edges), US-051 (register)
  - Layered shadows (two box-shadow values) create more natural depth than a single shadow
  - Explicit font-family with fallback handles fonts that may not be loaded yet
---

## 2025-01-12 - US-049
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Modified generateNodes.ts to automatically create LevelNode for slides with level property
- Added LEVEL_NODE_X_OFFSET (450px) and LEVEL_NODE_Y_OFFSET (-20px) constants
- LevelNode is created for each slide where slide.level !== undefined
- Level node ID follows pattern: 'level-{slideId}'
- Level node data includes: level number, slideId reference, and track from parent section
- Updated function documentation to describe level node positioning
- Verified typecheck passes
- Files changed: src/utils/generateNodes.ts
- **Learnings for future iterations:**
  - Level nodes are created within the slide generation loop for easy access to slide position
  - Track comes from the section, not the slide (slides don't have track property)
  - Position offsets are relative to slide position (slideX + offset, slideY + offset)
---

## 2025-01-12 - US-050
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Added slide-to-level edge style in EDGE_STYLES constant (1.5px dashed gray-400 stroke)
- Added logic to generate edges from slides to level nodes for slides with level property
- Edge connects slide (right handle) to level node (left handle)
- Edge ID follows pattern: 'edge-slide-{slideId}-to-level'
- Updated function JSDoc to document the new edge type
- Verified typecheck passes
- Files changed: src/utils/generateEdges.ts
- **Learnings for future iterations:**
  - Follow existing EDGE_STYLES pattern for new edge types
  - Check slide.level !== undefined to filter slides with levels
  - Level node target ID is 'level-{slideId}' matching generateNodes.ts pattern
---

## 2025-01-12 - US-051
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Registered LevelNode type in PresentationCanvas so React Flow can render level nodes
- Imported LevelNode component from ./nodes/LevelNode
- Added 'level': LevelNode to nodeTypes object alongside slide, sectionHeader, resource, paperBackground
- Verified typecheck passes
- Files changed: src/components/PresentationCanvas.tsx
- **Learnings for future iterations:**
  - All custom node types must be registered in nodeTypes object passed to ReactFlow component
  - Follow alphabetical-ish order in nodeTypes for consistency (level comes after resource)
  - LevelNode completes the level feature started in US-046 through US-050
---

## 2025-01-12 - US-052
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Removed level badge span from SlideNode.tsx (lines 115-117)
- Removed .slide-node__level CSS class from SlideNode.css (15 lines of styling)
- Level display now handled by separate LevelNode component (implemented in US-046-051)
- Verified in browser: no level badge overlays on slide hero images
- Verified typecheck passes
- Files changed: src/components/nodes/SlideNode.tsx, src/components/nodes/SlideNode.css
- **Learnings for future iterations:**
  - When moving functionality to a separate component, remove the old implementation completely
  - SlideNode now has cleaner JSX with hero image area containing only the img element
  - CSS cleanup reduces bundle size slightly and prevents dead code
---

## 2025-01-12 - US-053
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Created src/hooks/useSlideNotes.ts for slide notes persistence
- Defined SlideNotes interface with notes string and customResources array
- Defined CustomResource interface with title and url fields
- Hook takes slideId parameter (string | null for flexibility)
- Loads notes from localStorage on slideId change using useEffect
- Provides saveNotes function that persists to localStorage and updates state
- Uses key format 'presentation-slide-notes-{slideId}'
- Includes version and timestamp for future migrations
- Graceful error handling for JSON parse and localStorage errors
- Files changed: src/hooks/useSlideNotes.ts (new file, 132 lines)
- **Learnings for future iterations:**
  - Follow same persistence pattern as persistence.ts (version, timestamp, data wrapper)
  - Export both interfaces (SlideNotes, CustomResource) for use in other components
  - Hook returns notes and saveNotes - simple interface for consumers
  - slideId can be null (no slide selected) - hook returns default empty notes in this case
---

## 2025-01-12 - US-054
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Created src/components/panels/EditorPanel.tsx component structure
- Created EditorPanelProps interface with slideId, slideData, isOpen, onClose
- slideData uses object with slide and section for complete context
- Returns null early when !isOpen, !slideId, or !slideData
- Renders panel container with header showing slide title and close button
- Added close button with X SVG icon and aria-label for accessibility
- Created EditorPanel.css with basic layout (position fixed, 320px width)
- Content area has placeholder text for future US-055/US-056 implementation
- Wrapped component in React.memo for performance optimization
- Files changed: src/components/panels/EditorPanel.tsx (new), src/components/panels/EditorPanel.css (new)
- **Learnings for future iterations:**
  - Panel components use position: fixed for overlay on the canvas
  - Use slideData object to pass both slide and section context
  - Early return pattern (if !condition return null) keeps component clean
  - Placeholder content helps identify areas for future implementation
---

## 2025-01-12 - US-055
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Added notes textarea to EditorPanel for markdown note editing
- Imported and used useSlideNotes hook to load/save notes for selected slide
- Created handleNotesChange callback with useCallback for auto-save on every keystroke
- Added labeled textarea with "Notes (Markdown)" label and placeholder text
- Added CSS styling for section, label, and textarea elements
- Textarea styled with monospace font, 200px min-height, focus states
- Notes persist to localStorage automatically via saveNotes function
- Files changed: src/components/panels/EditorPanel.tsx, src/components/panels/EditorPanel.css
- **Learnings for future iterations:**
  - Use spread operator to preserve existing notes object while updating specific field
  - useCallback memoization helps prevent unnecessary re-renders
  - CSS custom properties (--color-accent) for focus ring color consistency
  - Textarea uses var(--font-mono) for markdown editing
---

## 2025-01-12 - US-056
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Added resource URL list to EditorPanel with add/delete functionality
- Imported useState from react and CustomResource from useSlideNotes hook
- Added state for add resource form: isAddingResource, newResourceTitle, newResourceUrl
- Created handleAddResource callback that validates inputs, adds to customResources array, and saves
- Created handleDeleteResource callback that filters out resource by index and saves
- Created handleCancelAddResource callback to reset form state
- Added resource list UI that displays customResources with title and URL
- Each resource item has clickable link (opens in new tab) and delete button
- Added "Add Resource" button that toggles add resource form
- Add resource form has title input, URL input, Cancel and Add buttons
- Add button disabled when either field is empty
- Added comprehensive CSS for resource list, items, links, delete buttons, form inputs, and buttons
- Files changed: src/components/panels/EditorPanel.tsx, src/components/panels/EditorPanel.css
- **Learnings for future iterations:**
  - Use index-based keys in map when list order is stable and items don't have unique IDs
  - Filter by index pattern: `array.filter((_, i) => i !== indexToRemove)`
  - Form state reset should happen after successful save, not before
  - Dashed border on add button creates visual distinction for "empty state" actions
---

## 2025-01-12 - US-057
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Completed EditorPanel CSS styling with slide-in animation
- Added @keyframes slideInFromLeft animation (0.25s ease-out)
- Added backdrop-filter blur(8px) for glass effect on panel
- Updated comment from "full styling in US-057" to "EditorPanel styles"
- All existing CSS was already complete from US-054/055/056 (position, dimensions, header, textarea, resources)
- Files changed: src/components/panels/EditorPanel.css
- **Learnings for future iterations:**
  - CSS animation keyframes use @keyframes declaration before the class that applies it
  - Use `animation: name duration timing-function fill-mode` shorthand for simple animations
  - `forwards` fill-mode keeps the element in its final animation state
  - backdrop-filter: blur() adds subtle glass morphism effect
  - EditorPanel will slide in from left once US-058 (integration) and US-059 (double-click) are complete
---

## 2025-01-12 - US-058
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Integrated EditorPanel component into PresentationCanvas
- Added selectedSlideId state (separate from currentSlideId used for navigation focus)
- Added isEditorOpen state to control panel visibility
- Imported EditorPanel from ./panels/EditorPanel
- Created handleCloseEditor callback that sets isEditorOpen to false
- Created editorSlideData useMemo that computes slide and section from selectedSlideId
- Passed all required props to EditorPanel: slideId, slideData, isOpen, onClose
- EditorPanel renders but won't appear until US-059 (double-click) sets selectedSlideId and isEditorOpen
- Files changed: src/components/PresentationCanvas.tsx
- **Learnings for future iterations:**
  - selectedSlideId is separate from currentSlideId: selected is for editing, current is for navigation focus
  - editorSlideData useMemo finds the slide and its section to pass complete context to EditorPanel
  - EditorPanel returns null when !isOpen so it's safe to always render in JSX
---

## 2025-01-12 - US-059
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Added onNodeDoubleClick handler to PresentationCanvas ReactFlow component
- Handler checks if clicked node is type "slide" before opening editor
- Extracts slideId from node ID (format: "slide-{id}")
- Sets selectedSlideId and isEditorOpen=true to open EditorPanel
- Other node types (sectionHeader, resource, level) are ignored
- Verified in browser: double-clicking slide opens EditorPanel on left
- Files changed: src/components/PresentationCanvas.tsx
- **Learnings for future iterations:**
  - onNodeDoubleClick follows same pattern as onNodeClick (uses NodeMouseHandler type)
  - Check node.type before processing to filter by node type
  - useCallback with empty deps array is fine when only using setState functions
  - EditorPanel will show with correct slide data due to editorSlideData useMemo
---
